{"remainingRequest":"/Users/huangjiehui/Desktop/Personal/vue/HYMall/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huangjiehui/Desktop/Personal/vue/HYMall/src/views/category/Category.vue?vue&type=style&index=0&id=163a9a75&scoped=true&lang=css&","dependencies":[{"path":"/Users/huangjiehui/Desktop/Personal/vue/HYMall/src/views/category/Category.vue","mtime":1584845842000},{"path":"/Users/huangjiehui/Desktop/Personal/vue/HYMall/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/huangjiehui/Desktop/Personal/vue/HYMall/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/huangjiehui/Desktop/Personal/vue/HYMall/node_modules/postcss-loader/lib/index.js","mtime":499162500000},{"path":"/Users/huangjiehui/Desktop/Personal/vue/HYMall/node_modules/cache-loader/dist/cjs.js","mtime":1630335031083},{"path":"/Users/huangjiehui/Desktop/Personal/vue/HYMall/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n#category {\n  height: 100vh;\n}\n\n.nav-bar {\n  background-color: var(--color-tint);\n  font-weight: 700;\n  color: #fff;\n}\n\n.content {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 44px;\n  bottom: 49px;\n\n  display: flex;\n}\n\n#tab-content {\n  height: 100%;\n  flex: 1;\n}\n",{"version":3,"sources":["Category.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqHA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA","file":"Category.vue","sourceRoot":"src/views/category","sourcesContent":["<template>\n  <div id=\"category\">\n    <nav-bar class=\"nav-bar\"><div slot=\"center\">商品分类</div></nav-bar>\n    <div class=\"content\">\n      <tab-menu :categories=\"categories\"\n                @selectItem=\"selectItem\"></tab-menu>\n\n      <scroll id=\"tab-content\" :data=\"[categoryData]\">\n        <div>\n          <tab-content-category :subcategories=\"showSubcategory\"></tab-content-category>\n          <tab-control :titles=\"['综合', '新品', '销量']\"\n                       @itemClick=\"tabClick\"></tab-control>\n          <tab-content-detail :category-detail=\"showCategoryDetail\"></tab-content-detail>\n        </div>\n      </scroll>\n    </div>\n  </div>\n</template>\n\n<script>\n  import NavBar from 'common/navbar/NavBar'\n\n  import TabMenu from './childComps/TabMenu'\n  import TabControl from 'content/tabControl/TabControl'\n  import Scroll from 'common/scroll/Scroll'\n  import TabContentCategory from './childComps/TabContentCategory'\n  import TabContentDetail from './childComps/TabContentDetail'\n\n  import {getCategory, getSubcategory, getCategoryDetail} from \"network/category\";\n  import {POP, SELL, NEW} from \"@/common/const\";\n  import {tabControlMixin} from \"@/common/mixin\";\n\n  export default {\n\t\tname: \"Category\",\n    components: {\n\t\t  NavBar,\n      TabMenu,\n      TabControl,\n      Scroll,\n      TabContentCategory,\n      TabContentDetail\n    },\n    mixins: [tabControlMixin],\n    data() {\n\t\t  return {\n\t\t    categories: [],\n        categoryData: {\n        },\n        currentIndex: -1\n      }\n    },\n    created() {\n\t\t  // 1.请求分类数据\n      this._getCategory()\n    },\n    computed: {\n\t\t  showSubcategory() {\n\t\t    if (this.currentIndex === -1) return {}\n        return this.categoryData[this.currentIndex].subcategories\n      },\n      showCategoryDetail() {\n\t\t    if (this.currentIndex === -1) return []\n\t\t    return this.categoryData[this.currentIndex].categoryDetail[this.currentType]\n      }\n    },\n    methods: {\n\t\t  _getCategory() {\n\t\t    getCategory().then(res => {\n\t\t      // 1.获取分类数据\n\t\t      this.categories = res.data.category.list\n          // 2.初始化每个类别的子数据\n          for (let i = 0; i < this.categories.length; i++) {\n            this.categoryData[i] = {\n              subcategories: {},\n              categoryDetail: {\n                'pop': [],\n                'new': [],\n                'sell': []\n              }\n            }\n          }\n          // 3.请求第一个分类的数据\n          this._getSubcategories(0)\n        })\n      },\n      _getSubcategories(index) {\n        this.currentIndex = index;\n\t\t    const mailKey = this.categories[index].maitKey;\n        getSubcategory(mailKey).then(res => {\n          this.categoryData[index].subcategories = res.data\n          this.categoryData = {...this.categoryData}\n          this._getCategoryDetail(POP)\n          this._getCategoryDetail(SELL)\n          this._getCategoryDetail(NEW)\n        })\n      },\n      _getCategoryDetail(type) {\n\t\t    // 1.获取请求的miniWallkey\n        const miniWallkey = this.categories[this.currentIndex].miniWallkey;\n        // 2.发送请求,传入miniWallkey和type\n\t\t    getCategoryDetail(miniWallkey, type).then(res => {\n\t\t      // 3.将获取的数据保存下来\n\t\t      this.categoryData[this.currentIndex].categoryDetail[type] = res\n          this.categoryData = {...this.categoryData}\n        })\n      },\n      /**\n       * 事件响应相关的方法\n       */\n      selectItem(index) {\n        this._getSubcategories(index)\n      }\n    }\n\t}\n</script>\n\n<style scoped>\n  #category {\n    height: 100vh;\n  }\n\n  .nav-bar {\n    background-color: var(--color-tint);\n    font-weight: 700;\n    color: #fff;\n  }\n\n  .content {\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 44px;\n    bottom: 49px;\n\n    display: flex;\n  }\n\n  #tab-content {\n    height: 100%;\n    flex: 1;\n  }\n</style>\n"]}]}