{"remainingRequest":"/Users/huangjiehui/Desktop/Personal/vue/HYMall/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huangjiehui/Desktop/Personal/vue/HYMall/src/views/detail/Detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/huangjiehui/Desktop/Personal/vue/HYMall/src/views/detail/Detail.vue","mtime":1584845842000},{"path":"/Users/huangjiehui/Desktop/Personal/vue/HYMall/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/huangjiehui/Desktop/Personal/vue/HYMall/node_modules/cache-loader/dist/cjs.js","mtime":1630335031083},{"path":"/Users/huangjiehui/Desktop/Personal/vue/HYMall/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n  import Scroll from 'common/scroll/Scroll'\n\n  import DetailNavBar from './childComps/DetailNavBar'\n  import DetailSwiper from './childComps/DetailSwiper'\n  import DetailBaseInfo from './childComps/DetailBaseInfo'\n  import DetailShopInfo from './childComps/DetailShopInfo'\n  import DetailGoodsInfo from './childComps/DetailGoodsInfo'\n  import DetailParamInfo from './childComps/DetailParamInfo'\n  import DetailCommentInfo from './childComps/DetailCommentInfo'\n  import DetailRecommendInfo from './childComps/DetailRecommendInfo'\n\n  import DetailBottomBar from './childComps/DetailBottomBar'\n  import BackTop from 'content/backTop/BackTop'\n\n  import {getDetail, getRecommend, Goods, Shop, GoodsParam} from \"network/detail\";\n  import {backTopMixin} from \"@/common/mixin\";\n  import {BACKTOP_DISTANCE} from \"@/common/const\";\n\n  export default {\n\t\tname: \"Detail\",\n    components: {\n      DetailBaseInfo,\n      DetailShopInfo,\n      DetailGoodsInfo,\n      DetailParamInfo,\n      DetailCommentInfo,\n      DetailRecommendInfo,\n      DetailBottomBar,\n\t\t  Scroll,\n\t\t  DetailNavBar,\n      DetailSwiper,\n      BackTop\n    },\n    mixins: [backTopMixin],\n    data() {\n\t\t  return {\n\t\t    iid: '',\n\t\t    topImages: [],\n        goods: {},\n        shop: {},\n        detailInfo: {},\n        paramInfo: {},\n        commentInfo: {},\n        recommendList: [],\n        themeTops: [],\n        currentIndex: 0\n      }\n    },\n    created() {\n\t\t  this._getDetailData()\n      this._getRecommend()\n    },\n    updated() {\n\t\t  // 获取需要的四个offsetTop\n      this._getOffsetTops()\n    },\n    methods: {\n\t\t  _getOffsetTops() {\n\t\t    this.themeTops = []\n        this.themeTops.push(this.$refs.base.$el.offsetTop)\n        this.themeTops.push(this.$refs.param.$el.offsetTop)\n        this.themeTops.push(this.$refs.comment.$el.offsetTop)\n        this.themeTops.push(this.$refs.recommend.$el.offsetTop)\n        this.themeTops.push(Number.MAX_VALUE)\n      },\n      contentScroll(position) {\n\t\t    // 1.监听backTop的显示\n        this.showBackTop = position.y < -BACKTOP_DISTANCE\n\n        // 2.监听滚动到哪一个主题\n        this._listenScrollTheme(-position.y)\n      },\n      _listenScrollTheme(position) {\n        let length = this.themeTops.length;\n        for (let i = 0; i < length; i++) {\n          let iPos = this.themeTops[i];\n          /**\n           * 判断的方案:\n           *  方案一:\n           *    条件: (i < (length-1) && currentPos >= iPos && currentPos < this.themeTops[i+1]) || (i === (length-1) && currentPos >= iPos),\n           *    优点: 不需要引入其他的内容, 通过逻辑解决\n           *    缺点: 判断条件过长, 并且不容易理解\n           *  方案二:\n           *    条件: 给themeTops最后添加一个很大的值, 用于和最后一个主题的top进行比较.\n           *    优点: 简洁明了, 便于理解\n           *    缺点: 需要引入一个较大的int数字\n           * 疑惑: 在第一个判断中, 为什么不能直接判断(currentPos >= iPos)即可?\n           * 解答: 比如在某一个currentPos大于第0个时, 就会break, 不会判断后面的i了.\n           */\n          if (position >= iPos && position < this.themeTops[i+1]) {\n            if (this.currentIndex !== i) {\n              this.currentIndex = i;\n            }\n            break;\n          }\n        }\n      },\n      titleClick(index) {\n        console.log(this.themeTops[index]);\n        this.$refs.scroll.scrollTo(0, -this.themeTops[index], 100)\n      },\n      addToCart() {\n        // 1.创建对象\n        const obj = {}\n        // 2.对象信息\n        obj.iid = this.iid;\n        obj.imgURL = this.topImages[0]\n        obj.title = this.goods.title\n        obj.desc = this.goods.desc;\n        obj.newPrice = this.goods.nowPrice;\n        // 3.添加到Store中\n        this.$store.commit('addCart', obj)\n      },\n\t\t  _getDetailData() {\n\t\t    // 1.获取iid\n        const iid = this.$route.query.iid\n        this.iid = iid\n\n        // 2.请求数据\n        getDetail(iid).then(res => {\n          // 2.1.获取结果\n          const data = res.result;\n\n          // 2.2.获取顶部信息\n          this.topImages = data.itemInfo.topImages;\n\n          // 2.3.获取商品信息\n          this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services);\n\n          // 2.4.获取店铺信息\n          this.shop = new Shop(data.shopInfo);\n\n          // 2.5.获取商品信息\n          this.detailInfo = data.detailInfo\n\n          // 2.6.保存参数信息\n          this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule);\n\n          // 2.7.保存评论信息\n          if (data.rate.list) {\n            this.commentInfo = data.rate.list[0];\n          }\n        })\n      },\n      _getRecommend() {\n        getRecommend().then((res, error) => {\n          if (error) return\n          this.recommendList = res.data.list\n        })\n      }\n    }\n\t}\n",{"version":3,"sources":["Detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AA0BA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Detail.vue","sourceRoot":"src/views/detail","sourcesContent":["<template>\n  <div id=\"detail\">\n    <detail-nav-bar @itemClick=\"titleClick\" :current-index=\"currentIndex\"></detail-nav-bar>\n    <scroll class=\"content\"\n            ref=\"scroll\"\n            @scroll=\"contentScroll\"\n            :data=\"[topImages, goods, shop, detailInfo, paramInfo, commentInfo, recommendList]\"\n            :probe-type=\"3\">\n      <div>\n        <detail-swiper ref=\"base\" :images=\"topImages\"></detail-swiper>\n        <detail-base-info :goods=\"goods\"></detail-base-info>\n        <detail-shop-info :shop=\"shop\"></detail-shop-info>\n        <detail-goods-info :detail-info=\"detailInfo\"></detail-goods-info>\n        <detail-param-info ref=\"param\" :param-info=\"paramInfo\"></detail-param-info>\n        <detail-comment-info ref=\"comment\" :comment-info=\"commentInfo\"></detail-comment-info>\n        <detail-recommend-info ref=\"recommend\" :recommend-list=\"recommendList\"></detail-recommend-info>\n      </div>\n    </scroll>\n    <detail-bottom-bar @addToCart=\"addToCart\"></detail-bottom-bar>\n    <back-top @backTop=\"backTop\" class=\"back-top\" v-show=\"showBackTop\">\n      <img src=\"~assets/img/common/top.png\" alt=\"\">\n    </back-top>\n  </div>\n</template>\n\n<script>\n  import Scroll from 'common/scroll/Scroll'\n\n  import DetailNavBar from './childComps/DetailNavBar'\n  import DetailSwiper from './childComps/DetailSwiper'\n  import DetailBaseInfo from './childComps/DetailBaseInfo'\n  import DetailShopInfo from './childComps/DetailShopInfo'\n  import DetailGoodsInfo from './childComps/DetailGoodsInfo'\n  import DetailParamInfo from './childComps/DetailParamInfo'\n  import DetailCommentInfo from './childComps/DetailCommentInfo'\n  import DetailRecommendInfo from './childComps/DetailRecommendInfo'\n\n  import DetailBottomBar from './childComps/DetailBottomBar'\n  import BackTop from 'content/backTop/BackTop'\n\n  import {getDetail, getRecommend, Goods, Shop, GoodsParam} from \"network/detail\";\n  import {backTopMixin} from \"@/common/mixin\";\n  import {BACKTOP_DISTANCE} from \"@/common/const\";\n\n  export default {\n\t\tname: \"Detail\",\n    components: {\n      DetailBaseInfo,\n      DetailShopInfo,\n      DetailGoodsInfo,\n      DetailParamInfo,\n      DetailCommentInfo,\n      DetailRecommendInfo,\n      DetailBottomBar,\n\t\t  Scroll,\n\t\t  DetailNavBar,\n      DetailSwiper,\n      BackTop\n    },\n    mixins: [backTopMixin],\n    data() {\n\t\t  return {\n\t\t    iid: '',\n\t\t    topImages: [],\n        goods: {},\n        shop: {},\n        detailInfo: {},\n        paramInfo: {},\n        commentInfo: {},\n        recommendList: [],\n        themeTops: [],\n        currentIndex: 0\n      }\n    },\n    created() {\n\t\t  this._getDetailData()\n      this._getRecommend()\n    },\n    updated() {\n\t\t  // 获取需要的四个offsetTop\n      this._getOffsetTops()\n    },\n    methods: {\n\t\t  _getOffsetTops() {\n\t\t    this.themeTops = []\n        this.themeTops.push(this.$refs.base.$el.offsetTop)\n        this.themeTops.push(this.$refs.param.$el.offsetTop)\n        this.themeTops.push(this.$refs.comment.$el.offsetTop)\n        this.themeTops.push(this.$refs.recommend.$el.offsetTop)\n        this.themeTops.push(Number.MAX_VALUE)\n      },\n      contentScroll(position) {\n\t\t    // 1.监听backTop的显示\n        this.showBackTop = position.y < -BACKTOP_DISTANCE\n\n        // 2.监听滚动到哪一个主题\n        this._listenScrollTheme(-position.y)\n      },\n      _listenScrollTheme(position) {\n        let length = this.themeTops.length;\n        for (let i = 0; i < length; i++) {\n          let iPos = this.themeTops[i];\n          /**\n           * 判断的方案:\n           *  方案一:\n           *    条件: (i < (length-1) && currentPos >= iPos && currentPos < this.themeTops[i+1]) || (i === (length-1) && currentPos >= iPos),\n           *    优点: 不需要引入其他的内容, 通过逻辑解决\n           *    缺点: 判断条件过长, 并且不容易理解\n           *  方案二:\n           *    条件: 给themeTops最后添加一个很大的值, 用于和最后一个主题的top进行比较.\n           *    优点: 简洁明了, 便于理解\n           *    缺点: 需要引入一个较大的int数字\n           * 疑惑: 在第一个判断中, 为什么不能直接判断(currentPos >= iPos)即可?\n           * 解答: 比如在某一个currentPos大于第0个时, 就会break, 不会判断后面的i了.\n           */\n          if (position >= iPos && position < this.themeTops[i+1]) {\n            if (this.currentIndex !== i) {\n              this.currentIndex = i;\n            }\n            break;\n          }\n        }\n      },\n      titleClick(index) {\n        console.log(this.themeTops[index]);\n        this.$refs.scroll.scrollTo(0, -this.themeTops[index], 100)\n      },\n      addToCart() {\n        // 1.创建对象\n        const obj = {}\n        // 2.对象信息\n        obj.iid = this.iid;\n        obj.imgURL = this.topImages[0]\n        obj.title = this.goods.title\n        obj.desc = this.goods.desc;\n        obj.newPrice = this.goods.nowPrice;\n        // 3.添加到Store中\n        this.$store.commit('addCart', obj)\n      },\n\t\t  _getDetailData() {\n\t\t    // 1.获取iid\n        const iid = this.$route.query.iid\n        this.iid = iid\n\n        // 2.请求数据\n        getDetail(iid).then(res => {\n          // 2.1.获取结果\n          const data = res.result;\n\n          // 2.2.获取顶部信息\n          this.topImages = data.itemInfo.topImages;\n\n          // 2.3.获取商品信息\n          this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services);\n\n          // 2.4.获取店铺信息\n          this.shop = new Shop(data.shopInfo);\n\n          // 2.5.获取商品信息\n          this.detailInfo = data.detailInfo\n\n          // 2.6.保存参数信息\n          this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule);\n\n          // 2.7.保存评论信息\n          if (data.rate.list) {\n            this.commentInfo = data.rate.list[0];\n          }\n        })\n      },\n      _getRecommend() {\n        getRecommend().then((res, error) => {\n          if (error) return\n          this.recommendList = res.data.list\n        })\n      }\n    }\n\t}\n</script>\n\n<style scoped>\n  #detail {\n    height: 100vh;\n    position: relative;\n    z-index: 1;\n    background-color: #fff;\n  }\n\n  .content {\n    position: absolute;\n    top: 44px;\n    bottom: 60px;\n  }\n\n  .back-top {\n    position: fixed;\n    right: 10px;\n    bottom: 65px;\n  }\n</style>\n"]}]}