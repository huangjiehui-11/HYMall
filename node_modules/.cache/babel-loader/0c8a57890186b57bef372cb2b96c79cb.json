{"remainingRequest":"/Users/huangjiehui/Desktop/Personal/vue/HYMall-master/node_modules/babel-loader/lib/index.js!/Users/huangjiehui/Desktop/Personal/vue/HYMall-master/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/huangjiehui/Desktop/Personal/vue/HYMall-master/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huangjiehui/Desktop/Personal/vue/HYMall-master/src/views/detail/Detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/huangjiehui/Desktop/Personal/vue/HYMall-master/src/views/detail/Detail.vue","mtime":1584845842000},{"path":"/Users/huangjiehui/Desktop/Personal/vue/HYMall-master/node_modules/cache-loader/dist/cjs.js","mtime":1630335031083},{"path":"/Users/huangjiehui/Desktop/Personal/vue/HYMall-master/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/huangjiehui/Desktop/Personal/vue/HYMall-master/node_modules/cache-loader/dist/cjs.js","mtime":1630335031083},{"path":"/Users/huangjiehui/Desktop/Personal/vue/HYMall-master/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Scroll from 'common/scroll/Scroll';\nimport DetailNavBar from './childComps/DetailNavBar';\nimport DetailSwiper from './childComps/DetailSwiper';\nimport DetailBaseInfo from './childComps/DetailBaseInfo';\nimport DetailShopInfo from './childComps/DetailShopInfo';\nimport DetailGoodsInfo from './childComps/DetailGoodsInfo';\nimport DetailParamInfo from './childComps/DetailParamInfo';\nimport DetailCommentInfo from './childComps/DetailCommentInfo';\nimport DetailRecommendInfo from './childComps/DetailRecommendInfo';\nimport DetailBottomBar from './childComps/DetailBottomBar';\nimport BackTop from 'content/backTop/BackTop';\nimport { getDetail, getRecommend, Goods, Shop, GoodsParam } from \"network/detail\";\nimport { backTopMixin } from \"@/common/mixin\";\nimport { BACKTOP_DISTANCE } from \"@/common/const\";\nexport default {\n  name: \"Detail\",\n  components: {\n    DetailBaseInfo: DetailBaseInfo,\n    DetailShopInfo: DetailShopInfo,\n    DetailGoodsInfo: DetailGoodsInfo,\n    DetailParamInfo: DetailParamInfo,\n    DetailCommentInfo: DetailCommentInfo,\n    DetailRecommendInfo: DetailRecommendInfo,\n    DetailBottomBar: DetailBottomBar,\n    Scroll: Scroll,\n    DetailNavBar: DetailNavBar,\n    DetailSwiper: DetailSwiper,\n    BackTop: BackTop\n  },\n  mixins: [backTopMixin],\n  data: function data() {\n    return {\n      iid: '',\n      topImages: [],\n      goods: {},\n      shop: {},\n      detailInfo: {},\n      paramInfo: {},\n      commentInfo: {},\n      recommendList: [],\n      themeTops: [],\n      currentIndex: 0\n    };\n  },\n  created: function created() {\n    this._getDetailData();\n\n    this._getRecommend();\n  },\n  updated: function updated() {\n    // 获取需要的四个offsetTop\n    this._getOffsetTops();\n  },\n  methods: {\n    _getOffsetTops: function _getOffsetTops() {\n      this.themeTops = [];\n      this.themeTops.push(this.$refs.base.$el.offsetTop);\n      this.themeTops.push(this.$refs.param.$el.offsetTop);\n      this.themeTops.push(this.$refs.comment.$el.offsetTop);\n      this.themeTops.push(this.$refs.recommend.$el.offsetTop);\n      this.themeTops.push(Number.MAX_VALUE);\n    },\n    contentScroll: function contentScroll(position) {\n      // 1.监听backTop的显示\n      this.showBackTop = position.y < -BACKTOP_DISTANCE; // 2.监听滚动到哪一个主题\n\n      this._listenScrollTheme(-position.y);\n    },\n    _listenScrollTheme: function _listenScrollTheme(position) {\n      var length = this.themeTops.length;\n\n      for (var i = 0; i < length; i++) {\n        var iPos = this.themeTops[i];\n        /**\n         * 判断的方案:\n         *  方案一:\n         *    条件: (i < (length-1) && currentPos >= iPos && currentPos < this.themeTops[i+1]) || (i === (length-1) && currentPos >= iPos),\n         *    优点: 不需要引入其他的内容, 通过逻辑解决\n         *    缺点: 判断条件过长, 并且不容易理解\n         *  方案二:\n         *    条件: 给themeTops最后添加一个很大的值, 用于和最后一个主题的top进行比较.\n         *    优点: 简洁明了, 便于理解\n         *    缺点: 需要引入一个较大的int数字\n         * 疑惑: 在第一个判断中, 为什么不能直接判断(currentPos >= iPos)即可?\n         * 解答: 比如在某一个currentPos大于第0个时, 就会break, 不会判断后面的i了.\n         */\n\n        if (position >= iPos && position < this.themeTops[i + 1]) {\n          if (this.currentIndex !== i) {\n            this.currentIndex = i;\n          }\n\n          break;\n        }\n      }\n    },\n    titleClick: function titleClick(index) {\n      console.log(this.themeTops[index]);\n      this.$refs.scroll.scrollTo(0, -this.themeTops[index], 100);\n    },\n    addToCart: function addToCart() {\n      // 1.创建对象\n      var obj = {}; // 2.对象信息\n\n      obj.iid = this.iid;\n      obj.imgURL = this.topImages[0];\n      obj.title = this.goods.title;\n      obj.desc = this.goods.desc;\n      obj.newPrice = this.goods.nowPrice; // 3.添加到Store中\n\n      this.$store.commit('addCart', obj);\n    },\n    _getDetailData: function _getDetailData() {\n      var _this = this;\n\n      // 1.获取iid\n      var iid = this.$route.query.iid;\n      this.iid = iid; // 2.请求数据\n\n      getDetail(iid).then(function (res) {\n        // 2.1.获取结果\n        var data = res.result; // 2.2.获取顶部信息\n\n        _this.topImages = data.itemInfo.topImages; // 2.3.获取商品信息\n\n        _this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services); // 2.4.获取店铺信息\n\n        _this.shop = new Shop(data.shopInfo); // 2.5.获取商品信息\n\n        _this.detailInfo = data.detailInfo; // 2.6.保存参数信息\n\n        _this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule); // 2.7.保存评论信息\n\n        if (data.rate.list) {\n          _this.commentInfo = data.rate.list[0];\n        }\n      });\n    },\n    _getRecommend: function _getRecommend() {\n      var _this2 = this;\n\n      getRecommend().then(function (res, error) {\n        if (error) return;\n        _this2.recommendList = res.data.list;\n      });\n    }\n  }\n};",{"version":3,"sources":["Detail.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div id=\"detail\">\n    <detail-nav-bar @itemClick=\"titleClick\" :current-index=\"currentIndex\"></detail-nav-bar>\n    <scroll class=\"content\"\n            ref=\"scroll\"\n            @scroll=\"contentScroll\"\n            :data=\"[topImages, goods, shop, detailInfo, paramInfo, commentInfo, recommendList]\"\n            :probe-type=\"3\">\n      <div>\n        <detail-swiper ref=\"base\" :images=\"topImages\"></detail-swiper>\n        <detail-base-info :goods=\"goods\"></detail-base-info>\n        <detail-shop-info :shop=\"shop\"></detail-shop-info>\n        <detail-goods-info :detail-info=\"detailInfo\"></detail-goods-info>\n        <detail-param-info ref=\"param\" :param-info=\"paramInfo\"></detail-param-info>\n        <detail-comment-info ref=\"comment\" :comment-info=\"commentInfo\"></detail-comment-info>\n        <detail-recommend-info ref=\"recommend\" :recommend-list=\"recommendList\"></detail-recommend-info>\n      </div>\n    </scroll>\n    <detail-bottom-bar @addToCart=\"addToCart\"></detail-bottom-bar>\n    <back-top @backTop=\"backTop\" class=\"back-top\" v-show=\"showBackTop\">\n      <img src=\"~assets/img/common/top.png\" alt=\"\">\n    </back-top>\n  </div>\n</template>\n\n<script>\n  import Scroll from 'common/scroll/Scroll'\n\n  import DetailNavBar from './childComps/DetailNavBar'\n  import DetailSwiper from './childComps/DetailSwiper'\n  import DetailBaseInfo from './childComps/DetailBaseInfo'\n  import DetailShopInfo from './childComps/DetailShopInfo'\n  import DetailGoodsInfo from './childComps/DetailGoodsInfo'\n  import DetailParamInfo from './childComps/DetailParamInfo'\n  import DetailCommentInfo from './childComps/DetailCommentInfo'\n  import DetailRecommendInfo from './childComps/DetailRecommendInfo'\n\n  import DetailBottomBar from './childComps/DetailBottomBar'\n  import BackTop from 'content/backTop/BackTop'\n\n  import {getDetail, getRecommend, Goods, Shop, GoodsParam} from \"network/detail\";\n  import {backTopMixin} from \"@/common/mixin\";\n  import {BACKTOP_DISTANCE} from \"@/common/const\";\n\n  export default {\n\t\tname: \"Detail\",\n    components: {\n      DetailBaseInfo,\n      DetailShopInfo,\n      DetailGoodsInfo,\n      DetailParamInfo,\n      DetailCommentInfo,\n      DetailRecommendInfo,\n      DetailBottomBar,\n\t\t  Scroll,\n\t\t  DetailNavBar,\n      DetailSwiper,\n      BackTop\n    },\n    mixins: [backTopMixin],\n    data() {\n\t\t  return {\n\t\t    iid: '',\n\t\t    topImages: [],\n        goods: {},\n        shop: {},\n        detailInfo: {},\n        paramInfo: {},\n        commentInfo: {},\n        recommendList: [],\n        themeTops: [],\n        currentIndex: 0\n      }\n    },\n    created() {\n\t\t  this._getDetailData()\n      this._getRecommend()\n    },\n    updated() {\n\t\t  // 获取需要的四个offsetTop\n      this._getOffsetTops()\n    },\n    methods: {\n\t\t  _getOffsetTops() {\n\t\t    this.themeTops = []\n        this.themeTops.push(this.$refs.base.$el.offsetTop)\n        this.themeTops.push(this.$refs.param.$el.offsetTop)\n        this.themeTops.push(this.$refs.comment.$el.offsetTop)\n        this.themeTops.push(this.$refs.recommend.$el.offsetTop)\n        this.themeTops.push(Number.MAX_VALUE)\n      },\n      contentScroll(position) {\n\t\t    // 1.监听backTop的显示\n        this.showBackTop = position.y < -BACKTOP_DISTANCE\n\n        // 2.监听滚动到哪一个主题\n        this._listenScrollTheme(-position.y)\n      },\n      _listenScrollTheme(position) {\n        let length = this.themeTops.length;\n        for (let i = 0; i < length; i++) {\n          let iPos = this.themeTops[i];\n          /**\n           * 判断的方案:\n           *  方案一:\n           *    条件: (i < (length-1) && currentPos >= iPos && currentPos < this.themeTops[i+1]) || (i === (length-1) && currentPos >= iPos),\n           *    优点: 不需要引入其他的内容, 通过逻辑解决\n           *    缺点: 判断条件过长, 并且不容易理解\n           *  方案二:\n           *    条件: 给themeTops最后添加一个很大的值, 用于和最后一个主题的top进行比较.\n           *    优点: 简洁明了, 便于理解\n           *    缺点: 需要引入一个较大的int数字\n           * 疑惑: 在第一个判断中, 为什么不能直接判断(currentPos >= iPos)即可?\n           * 解答: 比如在某一个currentPos大于第0个时, 就会break, 不会判断后面的i了.\n           */\n          if (position >= iPos && position < this.themeTops[i+1]) {\n            if (this.currentIndex !== i) {\n              this.currentIndex = i;\n            }\n            break;\n          }\n        }\n      },\n      titleClick(index) {\n        console.log(this.themeTops[index]);\n        this.$refs.scroll.scrollTo(0, -this.themeTops[index], 100)\n      },\n      addToCart() {\n        // 1.创建对象\n        const obj = {}\n        // 2.对象信息\n        obj.iid = this.iid;\n        obj.imgURL = this.topImages[0]\n        obj.title = this.goods.title\n        obj.desc = this.goods.desc;\n        obj.newPrice = this.goods.nowPrice;\n        // 3.添加到Store中\n        this.$store.commit('addCart', obj)\n      },\n\t\t  _getDetailData() {\n\t\t    // 1.获取iid\n        const iid = this.$route.query.iid\n        this.iid = iid\n\n        // 2.请求数据\n        getDetail(iid).then(res => {\n          // 2.1.获取结果\n          const data = res.result;\n\n          // 2.2.获取顶部信息\n          this.topImages = data.itemInfo.topImages;\n\n          // 2.3.获取商品信息\n          this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services);\n\n          // 2.4.获取店铺信息\n          this.shop = new Shop(data.shopInfo);\n\n          // 2.5.获取商品信息\n          this.detailInfo = data.detailInfo\n\n          // 2.6.保存参数信息\n          this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule);\n\n          // 2.7.保存评论信息\n          if (data.rate.list) {\n            this.commentInfo = data.rate.list[0];\n          }\n        })\n      },\n      _getRecommend() {\n        getRecommend().then((res, error) => {\n          if (error) return\n          this.recommendList = res.data.list\n        })\n      }\n    }\n\t}\n</script>\n\n<style scoped>\n  #detail {\n    height: 100vh;\n    position: relative;\n    z-index: 1;\n    background-color: #fff;\n  }\n\n  .content {\n    position: absolute;\n    top: 44px;\n    bottom: 60px;\n  }\n\n  .back-top {\n    position: fixed;\n    right: 10px;\n    bottom: 65px;\n  }\n</style>\n"],"sourceRoot":"src/views/detail"}]}